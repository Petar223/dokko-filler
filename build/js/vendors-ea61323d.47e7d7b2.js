"use strict";(self.webpackChunkdokko_filler=self.webpackChunkdokko_filler||[]).push([[986],{78741:(e,t,n)=>{function o(e){return Object.entries(e).map((([e,t])=>({Name:e,Value:t})))}n.d(t,{Q:()=>o})},75446:(e,t,n)=>{n.d(t,{Q:()=>r});var o=n(26886),i=n(11015),a=n(80602),s=n(35781);const r=async()=>{try{o.YZ.dispatch("auth",{event:"signedIn",data:await(0,i.H)()},"Auth",o.U9)}catch(e){if(e.name===a.zz)throw new s.l({name:a.yA,message:"Unable to get user session following successful sign-in.",recoverySuggestion:"This most likely is due to auth tokens not being persisted. If you are using cookie store, please ensure cookies can be correctly set from your server."});throw e}}},46718:(e,t,n)=>{n.d(t,{x:()=>g});var o=n(42953),i=n(26886),a=n(36021);var s=n(57675),r=n(69871),c=n(80602);const u=e=>e.startsWith(String(window.location.origin+window.location.pathname??"/")),l=e=>e.includes(String(window.location.hostname)),d=e=>e.startsWith("http://"),S=e=>e.startsWith("https://"),I=async(e,t=!1,n)=>{(0,s.G6)(e);const{loginWith:o,userPoolClientId:i}=e,{domain:a,redirectSignOut:I}=o.oauth,g=function(e,t){if(t){const n=e?.find((e=>e===t));if(!n)throw c.jK;return n}{const t=e?.find(u)??e?.find(l),n=e?.find(S)??e?.find(d);if(t)return t;if(n)throw c.$6;throw c.RW}}(I,n),h=`https://${a}/logout?${Object.entries({client_id:i,logout_uri:encodeURIComponent(g)}).map((([e,t])=>`${e}=${t}`)).join("&")}`;return(0,r.z)(h)},g=async(e,t,n,s)=>{const{isOAuthSignIn:r}=await t.loadOAuthSignIn(),c=await n.getOAuthMetadata();if(await(async e=>{await e.clearOAuthData(),a.o.clearTokens(),await(0,o.s)(),i.YZ.dispatch("auth",{event:"signedOut"},"Auth",i.U9)})(t),r||c?.oauthSignIn)return I(e,!1,s)}},2864:(e,t,n)=>{n.d(t,{I:()=>i});const o=[],i=e=>{o.push(e)}},19102:(e,t,n)=>{n.d(t,{f:()=>i});var o=n(10612);const i=new(n(43647).S)(o.ZL)},44815:(e,t,n)=>{n.d(t,{s:()=>S});var o=n(57675),i=n(72951),a=n(36118),s=n(73917),r=n(35781),c=n(23095),u=n(73696),l=n(77232);const d=async({tokens:e,authConfig:t,username:n})=>{(0,o.$y)(t?.Cognito);const{userPoolId:i,userPoolClientId:d,userPoolEndpoint:S}=t.Cognito,I=(0,a.J)(i);(0,s.X4)(e);const g=e.refreshToken,h={REFRESH_TOKEN:g};e.deviceMetadata?.deviceKey&&(h.DEVICE_KEY=e.deviceMetadata.deviceKey);const E=(0,l.d)({username:n,userPoolId:i,userPoolClientId:d}),C=(0,c.R)({endpointResolver:(0,u.o)({endpointOverride:S})}),{AuthenticationResult:_}=await C({region:I},{ClientId:d,AuthFlow:"REFRESH_TOKEN_AUTH",AuthParameters:h,UserContextData:E}),A=(0,o.Cq)(_?.AccessToken??""),P=_?.IdToken?(0,o.Cq)(_.IdToken):void 0,{iat:p}=A.payload;if(!p)throw new r.l({name:"iatNotFoundException",message:"iat not found in access token"});return{accessToken:A,idToken:P,clockDrift:1e3*p-(new Date).getTime(),refreshToken:g,username:n}},S=(0,i.W)(d)},21859:(e,t,n)=>{n.d(t,{AR:()=>b,Zw:()=>U,d5:()=>q,ff:()=>K,h5:()=>D,iG:()=>B,iI:()=>J,m$:()=>W,ni:()=>z,q2:()=>H,tE:()=>F,ty:()=>k});var o=n(20126),i=n(31317),a=n(57675),s=n(1478),r=n(72065),c=n(2049),u=n(35781),l=n(30831),d=n(21899),S=n(80602),I=n(11015),g=n(29856),h=n(23095),E=n(62805),C=n(74896),_=n(15432),A=n(73696),P=n(36118),p=n(46300),f=n(35717),m=n(59948),y=n(73917),O=n(80824),R=n(61526),w=n(81357),T=n(46367),v=n(41105),N=n(77232);const M="userAttributes.";async function D(e,t,n,o,a){const{userPoolClientId:s,userPoolId:r,userPoolEndpoint:c}=o,u={USERNAME:e,PASSWORD:t},l=await a.getDeviceMetadata(e);l&&l.deviceKey&&(u.DEVICE_KEY=l.deviceKey);const d={AuthFlow:"USER_PASSWORD_AUTH",AuthParameters:u,ClientMetadata:n,ClientId:s,UserContextData:(0,N.d)({username:e,userPoolId:r,userPoolClientId:s})},S=(0,h.R)({endpointResolver:(0,A.o)({endpointOverride:c})}),I=await S({region:(0,P.J)(r),userAgentValue:(0,g.A)(i.BM.SignIn)},d),E=I.ChallengeParameters?.USERNAME??I.ChallengeParameters?.USER_ID_FOR_SRP??e;return q(E),"DEVICE_SRP_AUTH"===I.ChallengeName?V({username:E,config:o,clientMetadata:n,session:I.Session,tokenOrchestrator:a}):I}async function U(e,t,n,o,i){return(0,f.L)({username:e,password:t,clientMetadata:n,config:o,tokenOrchestrator:i,authFlow:"USER_SRP_AUTH"})}async function k(e,t,n,o){const{userPoolClientId:a,userPoolId:s,userPoolEndpoint:r}=n,c={USERNAME:e},u=await o.getDeviceMetadata(e);u&&u.deviceKey&&(c.DEVICE_KEY=u.deviceKey);const l={AuthFlow:"CUSTOM_AUTH",AuthParameters:c,ClientMetadata:t,ClientId:a,UserContextData:(0,N.d)({username:e,userPoolId:s,userPoolClientId:a})},d=(0,h.R)({endpointResolver:(0,A.o)({endpointOverride:r})}),S=await d({region:(0,P.J)(s),userAgentValue:(0,g.A)(i.BM.SignIn)},l),I=S.ChallengeParameters?.USERNAME??e;return q(I),"DEVICE_SRP_AUTH"===S.ChallengeName?V({username:I,config:n,clientMetadata:t,session:S.Session,tokenOrchestrator:o}):S}async function F(e,t,n,o,s){(0,a.$y)(o);const{userPoolId:r,userPoolClientId:c,userPoolEndpoint:u}=o,l=r?.split("_")[1]||"",d=await(0,O.H)(l),S={AuthFlow:"CUSTOM_AUTH",AuthParameters:{USERNAME:e,SRP_A:d.A.toString(16),CHALLENGE_NAME:"SRP_A"},ClientMetadata:n,ClientId:c,UserContextData:(0,N.d)({username:e,userPoolId:r,userPoolClientId:c})},I=(0,h.R)({endpointResolver:(0,A.o)({endpointOverride:u})}),{ChallengeParameters:E,Session:C}=await I({region:(0,P.J)(r),userAgentValue:(0,g.A)(i.BM.SignIn)},S),_=E?.USERNAME??e;return q(_),J(K,[t,E,n,C,d,o,s],_,s)}async function V({username:e,config:t,clientMetadata:n,session:o,tokenOrchestrator:i}){const{userPoolId:a,userPoolEndpoint:s}=t,r=t.userPoolClientId,c=await(i?.getDeviceMetadata(e));(0,y.O_)(c);const u=await(0,O.H)(c.deviceGroupKey),l={ChallengeName:"DEVICE_SRP_AUTH",ClientId:r,ChallengeResponses:{USERNAME:e,SRP_A:u.A.toString(16),DEVICE_KEY:c.deviceKey},ClientMetadata:n,Session:o},d=(0,E.H)({endpointResolver:(0,A.o)({endpointOverride:s})}),{ChallengeParameters:S,Session:I}=await d({region:(0,P.J)(a)},l);return async function(e,t,n,o,i,{userPoolId:a,userPoolClientId:s,userPoolEndpoint:r},c){const u=await(c?.getDeviceMetadata(e));(0,y.O_)(u);const l=new v.A(t?.SRP_B,16),d=new v.A(t?.SALT,16),{deviceKey:S}=u,{deviceGroupKey:I}=u,g=await i.getPasswordAuthenticationKey({username:u.deviceKey,password:u.randomPassword,serverBValue:l,salt:d}),h=(0,w.q)(),C={USERNAME:t?.USERNAME??e,PASSWORD_CLAIM_SECRET_BLOCK:t?.SECRET_BLOCK,TIMESTAMP:h,PASSWORD_CLAIM_SIGNATURE:(0,T.I)({username:S,userPoolName:I,challengeParameters:t,dateNow:h,hkdf:g}),DEVICE_KEY:S},_=(0,N.d)({username:e,userPoolId:a,userPoolClientId:s}),p={ChallengeName:"DEVICE_PASSWORD_VERIFIER",ClientId:s,ChallengeResponses:C,Session:o,ClientMetadata:n,UserContextData:_},f=(0,E.H)({endpointResolver:(0,A.o)({endpointOverride:r})});return f({region:(0,P.J)(a)},p)}(e,S,n,I,u,t,i)}async function K(e,t,n,o,i,a,s){const{userPoolId:r,userPoolClientId:c,userPoolEndpoint:l}=a,d=r?.split("_")[1]||"",S=new v.A(t?.SRP_B,16),I=new v.A(t?.SALT,16),g=t?.USER_ID_FOR_SRP;if(!g)throw new u.l({name:"EmptyUserIdForSRPException",message:"USER_ID_FOR_SRP was not found in challengeParameters"});const h=await i.getPasswordAuthenticationKey({username:g,password:e,serverBValue:S,salt:I}),C=(0,w.q)(),_={USERNAME:g,PASSWORD_CLAIM_SECRET_BLOCK:t?.SECRET_BLOCK,TIMESTAMP:C,PASSWORD_CLAIM_SIGNATURE:(0,T.I)({username:g,userPoolName:d,challengeParameters:t,dateNow:C,hkdf:h})},p=await s.getDeviceMetadata(g);p&&p.deviceKey&&(_.DEVICE_KEY=p.deviceKey);const f={ChallengeName:"PASSWORD_VERIFIER",ChallengeResponses:_,ClientMetadata:n,Session:o,ClientId:c,UserContextData:(0,N.d)({username:g,userPoolId:r,userPoolClientId:c})},m=(0,E.H)({endpointResolver:(0,A.o)({endpointOverride:l})}),y=await m({region:(0,P.J)(r)},f);return"DEVICE_SRP_AUTH"===y.ChallengeName?V({username:g,config:a,clientMetadata:n,session:y.Session,tokenOrchestrator:s}):y}async function H(e){const{challengeName:t,challengeParameters:n,availableChallenges:i}=e,s=o.H.getConfig().Auth?.Cognito;switch((0,a.$y)(s),t){case"CUSTOM_CHALLENGE":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_CUSTOM_CHALLENGE",additionalInfo:n}};case"MFA_SETUP":{const{signInSession:e,username:t}=m.c$.getState(),o=G(Y(n.MFAS_CAN_SETUP))||[],i=o.filter((e=>"EMAIL"===e||"TOTP"===e)),a=i.includes("TOTP"),r=i.includes("EMAIL");if(a&&r)return{isSignedIn:!1,nextStep:{signInStep:"CONTINUE_SIGN_IN_WITH_MFA_SETUP_SELECTION",allowedMFATypes:i}};if(r)return{isSignedIn:!1,nextStep:{signInStep:"CONTINUE_SIGN_IN_WITH_EMAIL_SETUP"}};if(a){const n=(0,C.i)({endpointResolver:(0,A.o)({endpointOverride:s.userPoolEndpoint})}),{Session:o,SecretCode:i}=await n({region:(0,P.J)(s.userPoolId)},{Session:e});return m.c$.dispatch({type:"SET_SIGN_IN_SESSION",value:o}),{isSignedIn:!1,nextStep:{signInStep:"CONTINUE_SIGN_IN_WITH_TOTP_SETUP",totpSetupDetails:L(i,t)}}}throw new u.l({name:d.nC.SignInException,message:`Cannot initiate MFA setup from available types: ${o}`})}case"NEW_PASSWORD_REQUIRED":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_NEW_PASSWORD_REQUIRED",missingAttributes:x(n.requiredAttributes)}};case"SELECT_MFA_TYPE":return{isSignedIn:!1,nextStep:{signInStep:"CONTINUE_SIGN_IN_WITH_MFA_SELECTION",allowedMFATypes:G(Y(n.MFAS_CAN_CHOOSE))}};case"SMS_OTP":case"SMS_MFA":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_SMS_CODE",codeDeliveryDetails:{deliveryMedium:n.CODE_DELIVERY_DELIVERY_MEDIUM,destination:n.CODE_DELIVERY_DESTINATION}}};case"SOFTWARE_TOKEN_MFA":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_TOTP_CODE"}};case"EMAIL_OTP":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_EMAIL_CODE",codeDeliveryDetails:{deliveryMedium:n.CODE_DELIVERY_DELIVERY_MEDIUM,destination:n.CODE_DELIVERY_DESTINATION}}};case"WEB_AUTHN":return(0,p._)(n);case"PASSWORD":case"PASSWORD_SRP":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_PASSWORD"}};case"SELECT_CHALLENGE":return{isSignedIn:!1,nextStep:{signInStep:"CONTINUE_SIGN_IN_WITH_FIRST_FACTOR_SELECTION",availableChallenges:i}}}throw new u.l({name:d.nC.SignInException,message:`An error occurred during the sign in process. ${t} challengeName returned by the underlying service was not addressed.`})}function L(e,t){return{sharedSecret:e,getSetupUri:(n,o)=>{const i=`otpauth://totp/${n}:${o??t}?secret=${e}&issuer=${n}`;return new s.o(i)}}}function W(e){return e===l.zh.PasswordResetRequiredException?{isSignedIn:!1,nextStep:{signInStep:"RESET_PASSWORD"}}:e===l.zh.UserNotConfirmedException?{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_UP"}}:void 0}function x(e){if(!e)return[];return JSON.parse(e).map((e=>e.includes(M)?e.replace(M,""):e))}function $(e){return"SMS_MFA"===e?"SMS":"SOFTWARE_TOKEN_MFA"===e?"TOTP":"EMAIL_OTP"===e?"EMAIL":void 0}function G(e){if(e)return e.map($).filter(Boolean)}function Y(e){return e?JSON.parse(e):[]}async function b(){let e;try{e=await(0,I.H)()}catch(e){}if(e&&e.userId&&e.username)throw new u.l({name:S.z0,message:"There is already a signed in user.",recoverySuggestion:"Call signOut before calling signIn again."})}async function B({userPoolId:e,userPoolEndpoint:t,newDeviceMetadata:n,accessToken:o}){if(!n)return;const i=e.split("_")[1]||"",a=await(0,O.H)(i),s=n?.DeviceKey,u=n?.DeviceGroupKey;try{await a.generateHashDevice(u??"",s??"")}catch(e){return}const l={Salt:r.Y.convert((0,R.d)(a.getSaltToHashDevices())),PasswordVerifier:r.Y.convert((0,R.d)(a.getVerifierDevices()))},d=a.getRandomPassword();try{const i=(0,_.w)({endpointResolver:(0,A.o)({endpointOverride:t})});return await i({region:(0,P.J)(e)},{AccessToken:o,DeviceName:await(0,c.Q)(),DeviceKey:n?.DeviceKey,DeviceSecretVerifierConfig:l}),{deviceKey:s,deviceGroupKey:u,randomPassword:d}}catch(e){return}}async function J(e,t,n,o){try{return await e(...t)}catch(i){if(i instanceof u.l&&"ResourceNotFoundException"===i.name&&i.message.includes("Device does not exist."))return await o.clearDeviceMetadata(n),e(...t);throw i}}function q(e){const{dispatch:t}=m.c$;t({type:"SET_USERNAME",value:e})}function z(e){return m.c$.getState().username??e}},43647:(e,t,n)=>{n.d(t,{S:()=>c});var o=n(57675),i=n(34395),a=n(73917);const s="amplify-signin-with-hostedUI",r="CognitoIdentityServiceProvider";class c{constructor(e){this.keyValueStorage=e}async clearOAuthInflightData(){(0,o.$y)(this.cognitoConfig);const e=u(r,this.cognitoConfig.userPoolClientId);await Promise.all([this.keyValueStorage.removeItem(e.inflightOAuth),this.keyValueStorage.removeItem(e.oauthPKCE),this.keyValueStorage.removeItem(e.oauthState)])}async clearOAuthData(){(0,o.$y)(this.cognitoConfig);const e=u(r,this.cognitoConfig.userPoolClientId);return await this.clearOAuthInflightData(),await this.keyValueStorage.removeItem(s),this.keyValueStorage.removeItem(e.oauthSignIn)}loadOAuthState(){(0,o.$y)(this.cognitoConfig);const e=u(r,this.cognitoConfig.userPoolClientId);return this.keyValueStorage.getItem(e.oauthState)}storeOAuthState(e){(0,o.$y)(this.cognitoConfig);const t=u(r,this.cognitoConfig.userPoolClientId);return this.keyValueStorage.setItem(t.oauthState,e)}loadPKCE(){(0,o.$y)(this.cognitoConfig);const e=u(r,this.cognitoConfig.userPoolClientId);return this.keyValueStorage.getItem(e.oauthPKCE)}storePKCE(e){(0,o.$y)(this.cognitoConfig);const t=u(r,this.cognitoConfig.userPoolClientId);return this.keyValueStorage.setItem(t.oauthPKCE,e)}setAuthConfig(e){this.cognitoConfig=e}async loadOAuthInFlight(){(0,o.$y)(this.cognitoConfig);const e=u(r,this.cognitoConfig.userPoolClientId);return"true"===await this.keyValueStorage.getItem(e.inflightOAuth)}async storeOAuthInFlight(e){(0,o.$y)(this.cognitoConfig);const t=u(r,this.cognitoConfig.userPoolClientId);await this.keyValueStorage.setItem(t.inflightOAuth,`${e}`)}async loadOAuthSignIn(){(0,o.$y)(this.cognitoConfig);const e=u(r,this.cognitoConfig.userPoolClientId),t=await this.keyValueStorage.getItem(s),[n,i]=(await this.keyValueStorage.getItem(e.oauthSignIn))?.split(",")??[];return{isOAuthSignIn:"true"===n||"true"===t,preferPrivateSession:"true"===i}}async storeOAuthSignIn(e,t=!1){(0,o.$y)(this.cognitoConfig);const n=u(r,this.cognitoConfig.userPoolClientId);await this.keyValueStorage.setItem(n.oauthSignIn,`${e},${t}`)}}const u=(e,t)=>(0,i.Qm)(a.f3)(e,t)},17409:(e,t,n)=>{n.d(t,{FR:()=>l,MT:()=>E,kL:()=>g});var o=n(26886),i=n(48393),a=n(35781),s=n(6369),r=n(80602),c=n(35031);const u=18e4;function l(e){const t=o.f3.listen("auth-internal",(async({payload:n})=>{if("confirmSignUp"===n.event){const i=n.data;i?.isSignUpComplete&&(o.f3.dispatch("auth-internal",{event:"autoSignIn"}),(0,s.K$)(h(e)),t())}})),n=setTimeout((()=>{t(),clearTimeout(n),(0,s.xO)()}),u)}function d(e,t){let n;return o=>{n||e(...o),clearTimeout(n),n=setTimeout((()=>{n=void 0}),t)}}const S=d((function(e,t,n){const o=Date.now(),c=setInterval((async()=>{if(Date.now()-o>u)clearInterval(c),n(new a.l({name:r.A0,message:"The account was not confirmed on time.",recoverySuggestion:"Try to verify your account by clicking the link sent your email or phone and then login manually."})),(0,s.xO)();else try{const n=await(0,i.J)(e);"CONFIRM_SIGN_UP"!==n.nextStep.signInStep&&(t(n),clearInterval(c),(0,s.xO)())}catch(e){clearInterval(c),n(e),(0,s.xO)()}}),5e3)}),300),I=d((async function(e,t,n){try{t("USER_AUTH"===e?.options?.authFlowType?await(0,c.k)(e):await(0,i.J)(e)),(0,s.xO)()}catch(e){n(e),(0,s.xO)()}}),300);function g(e){return async()=>new Promise(((t,n)=>{S([e,t,n])}))}function h(e){return async()=>new Promise(((t,n)=>{I([e,t,n])}))}const E=h}}]);